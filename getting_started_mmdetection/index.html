



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for IceVision.">
      
      
        <link rel="canonical" href="https://airctic.com/getting_started_mmdetection/">
      
      
        <meta name="author" content="Lucas Goulart Vazquez, Farid Hassainia, and Contributors">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>Getting Started with MMDetection - IceVision</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#2094f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
      <link rel="manifest" href="../manifest.webmanifest" crossorigin="use-credentials">
    
    
      <link rel="stylesheet" href="../css/termynal.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quickstart" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://airctic.com/" title="IceVision" class="md-header-nav__button md-logo" aria-label="IceVision">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            IceVision
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Getting Started with MMDetection
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/airctic/IceVision" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://airctic.com/" title="IceVision" class="md-nav__button md-logo" aria-label="IceVision">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    IceVision
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/airctic/IceVision" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Tutorials
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../getting_started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Getting Started with MMDetection
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Getting Started with MMDetection" class="md-nav__link md-nav__link--active">
      Getting Started with MMDetection
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-icevision-and-icedata" class="md-nav__link">
    Installing IceVision and IceData
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-installation" class="md-nav__link">
    MMDetection Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-pytorch-installation" class="md-nav__link">
    Check Pytorch installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmcv-full-version-installation" class="md-nav__link">
    MMCV Full-Version Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#if-mmdet-is-not-recognized-restart-runtime-from-the-runtime-menu" class="md-nav__link">
    If mmdet is not recognized, Restart Runtime from the "Runtime Menu"
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imports" class="md-nav__link">
    Imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-models-information" class="md-nav__link">
    MMDetection Models Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-a-model-to-train" class="md-nav__link">
    Select a Model to train
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    Datasets :
  </a>
  
    <nav class="md-nav" aria-label="Datasets :">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-pretrained-weights" class="md-nav__link">
    Downloading Pretrained Weights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-configuration-file" class="md-nav__link">
    MMDetection Configuration File
  </a>
  
    <nav class="md-nav" aria-label="MMDetection Configuration File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-model-config-file" class="md-nav__link">
    Updating the Model Config File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-loss_weigts-1" class="md-nav__link">
    Default loss_weigt(s) = 1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-model-config-attributes" class="md-nav__link">
    Updating Model Config attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-model" class="md-nav__link">
    Creating a Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-fastai" class="md-nav__link">
    Training - Fastai
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-pytorch-lightning" class="md-nav__link">
    Training - Pytorch-Lightning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#show-results" class="md-nav__link">
    Show Results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference" class="md-nav__link">
    Inference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#happy-learning" class="md-nav__link">
    Happy Learning!
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../quickstart/" title="Quickstart using EfficientDet" class="md-nav__link">
      Quickstart using EfficientDet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../retinanet/" title="Quickstart using RetinaNet" class="md-nav__link">
      Quickstart using RetinaNet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../custom_parser/" title="Custom Parser" class="md-nav__link">
      Custom Parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../inference/" title="Inference" class="md-nav__link">
      Inference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mask_rcnn_pennfudan/" title="Mask RCNN" class="md-nav__link">
      Mask RCNN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ochuman_keypoint_detection/" title="Keypoints RCNN" class="md-nav__link">
      Keypoints RCNN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../efficientdet_pets/" title="EffecientDet" class="md-nav__link">
      EffecientDet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset_voc_nb/" title="Training a VOC dataset" class="md-nav__link">
      Training a VOC dataset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wandb_efficientdet/" title="Model Tracking Using Wandb" class="md-nav__link">
      Model Tracking Using Wandb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../negative_samples/" title="How to use negative samples" class="md-nav__link">
      How to use negative samples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../voc_predefined_splits/" title="Fixed Splitter" class="md-nav__link">
      Fixed Splitter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/getting_started_exp/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/quickstart_exp/" title="Quickstart" class="md-nav__link">
      Quickstart
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/inference_exp/" title="Inference" class="md-nav__link">
      Inference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/efficientdet_pets_exp/" title="EffecientDet" class="md-nav__link">
      EffecientDet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/mask_rcnn_pennfudan_exp/" title="Mask RCNN" class="md-nav__link">
      Mask RCNN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/dataset_voc_exp/" title="Training a VOC dataset" class="md-nav__link">
      Training a VOC dataset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/backbones_faster_rcnn/" title="Backbones - Faster RCNN" class="md-nav__link">
      Backbones - Faster RCNN
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Transforms
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Transforms" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Transforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../albumentations/" title="Albumentations" class="md-nav__link">
      Albumentations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Models
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Models" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../model_efficientdet/" title="EffecientDet" class="md-nav__link">
      EffecientDet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../model_faster_rcnn/" title="Faster RCNN" class="md-nav__link">
      Faster RCNN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../model_comparison/" title="Models Comparison" class="md-nav__link">
      Models Comparison
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Backbones
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Backbones" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Backbones
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../backbones_effecientdet/" title="EffecientDet" class="md-nav__link">
      EffecientDet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backbones_faster_mask_rcnn/" title="Faster/Mask RCNN" class="md-nav__link">
      Faster/Mask RCNN
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Deployment
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deployment" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Deployment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployment/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Gradio
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Gradio" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        <span class="md-nav__icon md-icon"></span>
        Gradio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../IceApp_coco/" title="COCO" class="md-nav__link">
      COCO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IceApp_pets/" title="PETS" class="md-nav__link">
      PETS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IceApp_masks/" title="Masks" class="md-nav__link">
      Masks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      API Documentation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API Documentation" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        API Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../parser/" title="Parser" class="md-nav__link">
      Parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset/" title="Dataset" class="md-nav__link">
      Dataset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-3" type="checkbox" id="nav-9-3">
    
    <label class="md-nav__link" for="nav-9-3">
      Transforms
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Transforms" data-md-level="2">
      <label class="md-nav__title" for="nav-9-3">
        <span class="md-nav__icon md-icon"></span>
        Transforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../albumentations_tfms/" title="Albumentations" class="md-nav__link">
      Albumentations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-4" type="checkbox" id="nav-9-4">
    
    <label class="md-nav__link" for="nav-9-4">
      Models
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Models" data-md-level="2">
      <label class="md-nav__title" for="nav-9-4">
        <span class="md-nav__icon md-icon"></span>
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-4-1" type="checkbox" id="nav-9-4-1">
    
    <label class="md-nav__link" for="nav-9-4-1">
      Faster RCNN
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Faster RCNN" data-md-level="3">
      <label class="md-nav__title" for="nav-9-4-1">
        <span class="md-nav__icon md-icon"></span>
        Faster RCNN
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../faster_rcnn/" title="common" class="md-nav__link">
      common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faster_rcnn_fastai/" title="fastai" class="md-nav__link">
      fastai
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faster_rcnn_lightning/" title="lightning" class="md-nav__link">
      lightning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-4-2" type="checkbox" id="nav-9-4-2">
    
    <label class="md-nav__link" for="nav-9-4-2">
      Mask RCNN
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Mask RCNN" data-md-level="3">
      <label class="md-nav__title" for="nav-9-4-2">
        <span class="md-nav__icon md-icon"></span>
        Mask RCNN
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mask_rcnn/" title="common" class="md-nav__link">
      common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mask_rcnn_fastai/" title="fastai" class="md-nav__link">
      fastai
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mask_rcnn_lightning/" title="lightning" class="md-nav__link">
      lightning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-4-3" type="checkbox" id="nav-9-4-3">
    
    <label class="md-nav__link" for="nav-9-4-3">
      EfficientDet
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="EfficientDet" data-md-level="3">
      <label class="md-nav__title" for="nav-9-4-3">
        <span class="md-nav__icon md-icon"></span>
        EfficientDet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../efficientdet/" title="common" class="md-nav__link">
      common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../efficientdet_fastai/" title="fastai" class="md-nav__link">
      fastai
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../efficientdet_lightning/" title="lightning" class="md-nav__link">
      lightning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_splits/" title="Data Splitters" class="md-nav__link">
      Data Splitters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../how-to/" title="How-To" class="md-nav__link">
      How-To
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing Guide" class="md-nav__link">
      Contributing Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../readme_mkdocs/" title="Generating Docs" class="md-nav__link">
      Generating Docs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Preferences
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Preferences" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        <span class="md-nav__icon md-icon"></span>
        Preferences
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../changing_the_colors/" title="Changing the colors" class="md-nav__link">
      Changing the colors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../code_of_conduct/" title="Code of Conduct" class="md-nav__link">
      Code of Conduct
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-icevision-and-icedata" class="md-nav__link">
    Installing IceVision and IceData
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-installation" class="md-nav__link">
    MMDetection Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-pytorch-installation" class="md-nav__link">
    Check Pytorch installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmcv-full-version-installation" class="md-nav__link">
    MMCV Full-Version Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#if-mmdet-is-not-recognized-restart-runtime-from-the-runtime-menu" class="md-nav__link">
    If mmdet is not recognized, Restart Runtime from the "Runtime Menu"
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imports" class="md-nav__link">
    Imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-models-information" class="md-nav__link">
    MMDetection Models Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-a-model-to-train" class="md-nav__link">
    Select a Model to train
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    Datasets :
  </a>
  
    <nav class="md-nav" aria-label="Datasets :">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-pretrained-weights" class="md-nav__link">
    Downloading Pretrained Weights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmdetection-configuration-file" class="md-nav__link">
    MMDetection Configuration File
  </a>
  
    <nav class="md-nav" aria-label="MMDetection Configuration File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-model-config-file" class="md-nav__link">
    Updating the Model Config File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-loss_weigts-1" class="md-nav__link">
    Default loss_weigt(s) = 1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-model-config-attributes" class="md-nav__link">
    Updating Model Config attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-model" class="md-nav__link">
    Creating a Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-fastai" class="md-nav__link">
    Training - Fastai
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-pytorch-lightning" class="md-nav__link">
    Training - Pytorch-Lightning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#show-results" class="md-nav__link">
    Show Results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference" class="md-nav__link">
    Inference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#happy-learning" class="md-nav__link">
    Happy Learning!
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <p><a href="https://colab.research.google.com/github/airctic/icevision/blob/master/notebooks/getting_started_mmdetection.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<h1 id="quickstart">Quickstart</h1>
<p><a href="https://github.com/open-mmlab/mmdetection">MMDetection</a></p>
<h2 id="introduction">Introduction</h2>
<p>This tutorial walk you through the different steps of training one of the MMDetection models supported in IceVision. We use either the Fridge Objects dataset or the PennFudan dataset. </p>
<p>The IceVision Framework is an <strong>agnostic framework</strong>. As an illustration, we will train our model using both the <a href="https://github.com/fastai/fastai">fastai</a> library, and <a href="https://github.com/PyTorchLightning/pytorch-lightning">pytorch-lightning</a> libraries.</p>
<p>For more information about how the fridge dataset as well as its corresponding parser check out the <a href="https://github.com/airctic/icedata">IceData repository</a>.</p>
<h2 id="installing-icevision-and-icedata">Installing IceVision and IceData</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># !pip install icevision[all] icedata -q</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">airctic</span><span class="o">/</span><span class="n">icevision</span><span class="o">.</span><span class="n">git</span><span class="c1">#egg=icevision[all] --upgrade -q</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># !pip install icedata -q</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">airctic</span><span class="o">/</span><span class="n">icedata</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">-</span><span class="n">q</span>
</code></pre></div>
<h2 id="mmdetection-installation">MMDetection Installation</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Install mmdetection</span>
<span class="err">!</span><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">mmdetection</span>
<span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="nb">open</span><span class="o">-</span><span class="n">mmlab</span><span class="o">/</span><span class="n">mmdetection</span><span class="o">.</span><span class="n">git</span>

<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="n">mmdetection</span> <span class="o">-</span><span class="n">q</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">ls</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>mmdetection  sample_data
</code></pre></div>
</div>
<h2 id="check-pytorch-installation">Check Pytorch installation</h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span><span class="o">,</span> <span class="nn">torchvision</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">torch_version</span><span class="p">,</span> <span class="n">cuda_version</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<span class="n">torch_version</span><span class="p">,</span> <span class="n">cuda_version</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>1.7.0+cu101 True

(&#39;1.7.0&#39;, &#39;cu101&#39;)
</code></pre></div>
</div>
<h2 id="mmcv-full-version-installation">MMCV Full-Version Installation</h2>
<div class="highlight"><pre><span></span><code><span class="n">mmcv_full_version</span> <span class="o">=</span> <span class="s2">&quot;1.2.5&quot;</span>
<span class="n">mmcv_full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://download.openmmlab.com/mmcv/dist/</span><span class="si">{</span><span class="n">cuda_version</span><span class="si">}</span><span class="s2">/torch</span><span class="si">{</span><span class="n">torch_version</span><span class="si">}</span><span class="s2">/index.html&quot;</span> <span class="c1">#e.g https://download.openmmlab.com/mmcv/dist/cu101/torch1.7.0/index.html </span>
<span class="n">mmcv_full_url</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">mmcv</span><span class="o">-</span><span class="n">full</span><span class="o">==</span><span class="p">{</span><span class="n">mmcv_full_version</span><span class="p">}</span> <span class="o">-</span><span class="n">f</span> <span class="p">{</span><span class="n">mmcv_full_url</span><span class="p">}</span> <span class="o">-</span><span class="n">U</span> <span class="o">-</span><span class="n">q</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Restart Runtime</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">restart_runtime</span><span class="p">():</span>
  <span class="n">os</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">restart_runtime</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">mmcv</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MMCV: &quot;</span><span class="p">,</span> <span class="n">mmcv</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Check MMDetection installation</span>
<span class="kn">import</span> <span class="nn">mmdet</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MMDetection: &quot;</span><span class="p">,</span> <span class="n">mmdet</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Check mmcv installation</span>
<span class="kn">from</span> <span class="nn">mmcv.ops</span> <span class="kn">import</span> <span class="n">get_compiling_cuda_version</span><span class="p">,</span> <span class="n">get_compiler_version</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_compiling_cuda_version</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_compiler_version</span><span class="p">())</span>
</code></pre></div></p>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>&#39;https://download.openmmlab.com/mmcv/dist/cu101/torch1.7.0/index.html&#39;

MMCV:  1.2.5

MMDetection:  2.9.0
10.1
GCC 7.3
</code></pre></div>
</div>
<h2 id="if-mmdet-is-not-recognized-restart-runtime-from-the-runtime-menu">If mmdet is not recognized, Restart Runtime from the "Runtime Menu"</h2>
<h2 id="imports">Imports</h2>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">icevision.all</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
<h2 id="mmdetection-models-information">MMDetection Models Information</h2>
<p>models_info contain all the necessary configuration information to build an MMDetection model. That includes:</p>
<ul>
<li>'model_name'</li>
<li>'model_type'</li>
<li>'cfg_filepath'</li>
<li>'weights_url'</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">all_models_info</span> <span class="o">=</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;cornernet&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">cornernet</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/cornernet/cornernet_hourglass104_mstest_32x3_210e_coco.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/cornernet/cornernet_hourglass104_mstest_32x3_210e_coco/cornernet_hourglass104_mstest_32x3_210e_coco_20200819_203110-1efaea91.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;centripetalnet&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">centripetalnet</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/centripetalnet/centripetalnet_hourglass104_mstest_16x6_210e_coco.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/centripetalnet/centripetalnet_hourglass104_mstest_16x6_210e_coco/centripetalnet_hourglass104_mstest_16x6_210e_coco_20200915_204804-3ccc61e5.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;retinanet&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">retinanet</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/_base_/models/retinanet_r50_fpn.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/retinanet/retinanet_r50_fpn_1x_coco/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;fcos&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">fcos</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/fcos/fcos_x101_64x4d_fpn_gn-head_mstrain_640-800_2x_coco.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/fcos/fcos_x101_64x4d_fpn_gn-head_mstrain_640-800_4x2_2x_coco/fcos_x101_64x4d_fpn_gn-head_mstrain_640-800_4x2_2x_coco_20200229-11f8c079.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;faster_rcnn&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">faster_rcnn</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_1x_coco/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="s2">&quot;mask_rcnn&quot;</span><span class="p">,</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="n">models</span><span class="o">.</span><span class="n">mmdet</span><span class="o">.</span><span class="n">mask_rcnn</span><span class="p">,</span>
            <span class="s1">&#39;cfg_filepath&#39;</span><span class="p">:</span> <span class="s2">&quot;mmdetection/configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py&quot;</span><span class="p">,</span>
            <span class="s1">&#39;weights_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_fpn_1x_coco/mask_rcnn_r50_fpn_1x_coco_20200205-d4b0c5d6.pth&quot;</span><span class="p">,</span>
          <span class="p">},</span>
        <span class="p">]</span>
</code></pre></div>
<h2 id="select-a-model-to-train">Select a Model to train</h2>
<p>You can select one of the following models: "retinanet", "fcos", "faster_rcnn", "mask_rcnn"</p>
<div class="highlight"><pre><span></span><code><span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;retinanet&quot;</span>  <span class="c1"># &quot;cornernet&quot;, &quot;centripetalnet&quot;, &quot;retinanet&quot;, &quot;fcos&quot;, &quot;faster_rcnn&quot;, &quot;mask_rcnn&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">model_info</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">m_info</span> <span class="k">for</span> <span class="n">m_info</span> <span class="ow">in</span> <span class="n">all_models_info</span> <span class="k">if</span> <span class="n">m_info</span><span class="p">[</span><span class="s2">&quot;model_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">model_name</span><span class="p">)</span>
<span class="n">model_info</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">model_type</span> <span class="o">=</span> <span class="n">model_info</span><span class="p">[</span><span class="s2">&quot;model_type&quot;</span><span class="p">]</span>
<span class="n">cfg_filepath</span> <span class="o">=</span> <span class="n">model_info</span><span class="p">[</span><span class="s2">&quot;cfg_filepath&quot;</span><span class="p">]</span>
<span class="n">weights_url</span> <span class="o">=</span> <span class="n">model_info</span><span class="p">[</span><span class="s2">&quot;weights_url&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>{&#39;cfg_filepath&#39;: &#39;mmdetection/configs/_base_/models/retinanet_r50_fpn.py&#39;,
 &#39;model_name&#39;: &#39;retinanet&#39;,
 &#39;model_type&#39;: &lt;module &#39;icevision.models.mmdet.models.retinanet&#39; from &#39;/usr/local/lib/python3.6/dist-packages/icevision/models/mmdet/models/retinanet/__init__.py&#39;&gt;,
 &#39;weights_url&#39;: &#39;http://download.openmmlab.com/mmdetection/v2.0/retinanet/retinanet_r50_fpn_1x_coco/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth&#39;}
</code></pre></div>
</div>
<h2 id="datasets">Datasets :</h2>
<ul>
<li>For Object Detection the Fridge Object Dataset will be used</li>
<li>For Mask Detection the PennFudan Dataset will be used</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="s2">&quot;mask&quot;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
  <span class="n">data_dir</span> <span class="o">=</span> <span class="n">icedata</span><span class="o">.</span><span class="n">pennfudan</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">icedata</span><span class="o">.</span><span class="n">pennfudan</span><span class="o">.</span><span class="n">parser</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">data_dir</span> <span class="o">=</span> <span class="n">icedata</span><span class="o">.</span><span class="n">fridge</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">icedata</span><span class="o">.</span><span class="n">fridge</span><span class="o">.</span><span class="n">parser</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">train_records</span><span class="p">,</span> <span class="n">valid_records</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="c1"># train_records[0]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">presize</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">384</span>

<span class="n">train_tfms</span> <span class="o">=</span> <span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">Adapter</span><span class="p">(</span>
    <span class="p">[</span><span class="o">*</span><span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">aug_tfms</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">presize</span><span class="o">=</span><span class="n">presize</span><span class="p">),</span> <span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">Normalize</span><span class="p">()]</span>
<span class="p">)</span>
<span class="n">valid_tfms</span> <span class="o">=</span> <span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">Adapter</span><span class="p">([</span><span class="o">*</span><span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">resize_and_pad</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span> <span class="n">tfms</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">Normalize</span><span class="p">()])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">train_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">train_records</span><span class="p">,</span> <span class="n">train_tfms</span><span class="p">)</span>
<span class="n">valid_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">valid_records</span><span class="p">,</span> <span class="n">valid_tfms</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">train_dl</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">train_dl</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">valid_dl</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">valid_dl</span><span class="p">(</span><span class="n">valid_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">parser</span><span class="o">.</span><span class="n">class_map</span>
</code></pre></div></p>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>  0%|          | 0/128 [00:00&lt;?, ?it/s]

[1m[1mINFO    [0m[1m[0m - [1m[34m[1mAutofixing records[0m[1m[34m[0m[1m[0m | [36micevision.parsers.parser[0m:[36mparse[0m:[36m132[0m

&lt;ClassMap: {&#39;background&#39;: 0, &#39;carton&#39;: 1, &#39;milk_bottle&#39;: 2, &#39;can&#39;: 3, &#39;water_bottle&#39;: 4}&gt;
</code></pre></div>
</div>
<h3 id="visualization">Visualization</h3>
<p>Showing some images</p>
<div class="highlight"><pre><span></span><code><span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">show_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">class_map</span><span class="o">=</span><span class="n">parser</span><span class="o">.</span><span class="n">class_map</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../images/getting_started_mmdetection/getting_started_mmdetection_36_0.png" /></p>
<h2 id="downloading-pretrained-weights">Downloading Pretrained Weights</h2>
<div class="highlight"><pre><span></span><code><span class="n">weights_url</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="n">checkpoints_dir</span> <span class="o">=</span> <span class="s2">&quot;checkpoints&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">mkdir</span> <span class="p">{</span><span class="n">checkpoints_dir</span><span class="p">}</span>
<span class="err">!</span><span class="n">wget</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">P</span> <span class="n">checkpoints</span><span class="o">/</span> <span class="p">{</span><span class="n">weights_url</span><span class="p">}</span>
</code></pre></div></p>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>&#39;http://download.openmmlab.com/mmdetection/v2.0/retinanet/retinanet_r50_fpn_1x_coco/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth&#39;

--2021-02-19 17:46:07--  http://download.openmmlab.com/mmdetection/v2.0/retinanet/retinanet_r50_fpn_1x_coco/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.254.186.225
Connecting to download.openmmlab.com (download.openmmlab.com)|47.254.186.225|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 152149505 (145M) [application/octet-stream]
Saving to: ‘checkpoints/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth’
</code></pre></div>
</div>

<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>retinanet_r50_fpn_1 100%[===================&gt;] 145.10M  8.53MB/s    in 23s     
</code></pre></div>
</div>

<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>2021-02-19 17:46:31 (6.44 MB/s) - ‘checkpoints/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth’ saved [152149505/152149505]
</code></pre></div>
</div>

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="p">{</span><span class="n">checkpoints_dir</span><span class="p">}</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth
</code></pre></div>
</div>
<h2 id="mmdetection-configuration-file">MMDetection Configuration File</h2>
<h3 id="updating-the-model-config-file">Updating the Model Config File</h3>
<blockquote>
<p>Note: You don't need to change the default config. Here, we are only showing how to change any default value stored in the config file. As an example, we are showing how to update the loss_weight(s) </p>
</blockquote>
<p>The original config files use the default <code>loss_weight=1</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Get the weights_path</span>
<span class="n">weights_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">weights_url</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="n">weights_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">checkpoints_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">weights_fname</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">weights_path</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="n">cfg_filepath</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mmcv</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">cfg_filepath</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># cfg.model.bbox_head</span>
</code></pre></div></p>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>&#39;checkpoints/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth&#39;

&#39;mmdetection/configs/_base_/models/retinanet_r50_fpn.py&#39;
</code></pre></div>
</div>
<h3 id="default-loss_weigts-1">Default <code>loss_weigt</code>(s) = 1</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># cfg.model.bbox_head.loss_cls, cfg.model.bbox_head.loss_bbox</span>
</code></pre></div>
<h2 id="updating-model-config-attributes">Updating Model Config attributes</h2>
<blockquote>
<p>Note: We can update any attributes defined in the python file where those attributes are populated</p>
</blockquote>
<p>In this example, we are updating the <code>loss_weigt</code>(s) with the following values</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cfg.model.bbox_head.loss_cls.loss_weight = 0.8</span>
<span class="c1"># cfg.model.bbox_head.loss_bbox.loss_weight = 2</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># cfg.model.bbox_head.loss_cls, cfg.model.bbox_head.loss_bbox</span>
</code></pre></div>
<h2 id="creating-a-model">Creating a Model</h2>
<div class="highlight"><pre><span></span><code><span class="n">weights_path</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">class_map</span><span class="p">),</span> <span class="n">weights_path</span><span class="o">=</span><span class="n">weights_path</span><span class="p">)</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>&#39;checkpoints/retinanet_r50_fpn_1x_coco_20200130-c2398f9e.pth&#39;
</code></pre></div>
</div>
<h2 id="training">Training</h2>
<h2 id="training-fastai">Training - Fastai</h2>
<div class="highlight"><pre><span></span><code><span class="n">learn</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">fastai</span><span class="o">.</span><span class="n">learner</span><span class="p">(</span><span class="n">dls</span><span class="o">=</span><span class="p">[</span><span class="n">train_dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="n">fastai</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>SuggestedLRs(lr_min=5.754399462603033e-05, lr_steep=0.00010964782268274575)
</code></pre></div>
</div>

<p><img alt="png" src="../images/getting_started_mmdetection/getting_started_mmdetection_59_2.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">learn</span><span class="o">.</span><span class="n">fine_tune</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">3e-4</span><span class="p">)</span>
</code></pre></div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.192961</td>
      <td>0.856517</td>
      <td>00:06</td>
    </tr>
  </tbody>
</table>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.692504</td>
      <td>0.536435</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.568239</td>
      <td>0.376043</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.492997</td>
      <td>0.340800</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.432057</td>
      <td>0.257431</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.383656</td>
      <td>0.228422</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.351317</td>
      <td>0.213184</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.333522</td>
      <td>0.237355</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.310363</td>
      <td>0.181096</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.294222</td>
      <td>0.193166</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.273112</td>
      <td>0.145784</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.252149</td>
      <td>0.161463</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.236207</td>
      <td>0.139669</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.219127</td>
      <td>0.149458</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.207551</td>
      <td>0.131850</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.198437</td>
      <td>0.144513</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.189129</td>
      <td>0.133218</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.177614</td>
      <td>0.119760</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.166518</td>
      <td>0.116883</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.158119</td>
      <td>0.114125</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.151817</td>
      <td>0.114225</td>
      <td>00:05</td>
    </tr>
  </tbody>
</table>

<h2 id="training-pytorch-lightning">Training - Pytorch-Lightning</h2>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LitModel</span><span class="p">(</span><span class="n">model_type</span><span class="o">.</span><span class="n">lightning</span><span class="o">.</span><span class="n">ModelAdapter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">configure_optimizers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>

<span class="n">lit_model</span> <span class="o">=</span> <span class="n">LitModel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_sanity_val_steps</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">check_val_every_n_epoch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">lr_finder</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">tuner</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">lit_model</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>/usr/local/lib/python3.6/dist-packages/pytorch_lightning/utilities/distributed.py:50: UserWarning: You have set progress_bar_refresh_rate &lt; 20 on Google Colab. This may crash. Consider using progress_bar_refresh_rate &gt;= 20 in Trainer.
  warnings.warn(*args, **kwargs)
GPU available: True, used: True
TPU available: None, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
</code></pre></div>
</div>

<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">lr_finder</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">suggest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>  | Name  | Type      | Params
------------------------------------
0 | model | RetinaNet | 36.4 M
------------------------------------
36.2 M    Trainable params
225 K     Non-trainable params
36.4 M    Total params

Finding best initial lr:   0%|          | 0/100 [00:00&lt;?, ?it/s]

LR finder stopped early due to diverging loss.
Restored states from the checkpoint file at /content/lr_find_temp_model.ckpt
</code></pre></div>
</div>

<p><img alt="png" src="../images/getting_started_mmdetection/getting_started_mmdetection_64_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">lit_model</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</code></pre></div>
<h2 id="show-results">Show Results</h2>
<div class="highlight"><pre><span></span><code><span class="n">model_type</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">detection_threshold</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../images/getting_started_mmdetection/getting_started_mmdetection_67_0.png" /></p>
<h2 id="inference">Inference</h2>
<div class="highlight"><pre><span></span><code><span class="n">infer_dl</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">infer_dl</span><span class="p">(</span><span class="n">valid_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">samples</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">model_type</span><span class="o">.</span><span class="n">predict_dl</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">infer_dl</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">show_preds</span><span class="p">(</span>
    <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">preds</span><span class="o">=</span><span class="n">preds</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">class_map</span><span class="o">=</span><span class="n">parser</span><span class="o">.</span><span class="n">class_map</span><span class="p">,</span>
    <span class="n">denormalize_fn</span><span class="o">=</span><span class="n">denormalize_imagenet</span><span class="p">,</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<div class="k-default-codeblock">
<div class="highlight"><pre><span></span><code>  0%|          | 0/26 [00:00&lt;?, ?it/s]
</code></pre></div>
</div>

<p><img alt="png" src="../images/getting_started_mmdetection/getting_started_mmdetection_71_0.png" /></p>
<h2 id="happy-learning">Happy Learning!</h2>
<p>If you need any assistance, feel free to join our <a href="https://discord.gg/JDBeZYK">forum</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../getting_started/" title="Getting Started" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Getting Started
              </div>
            </div>
          </a>
        
        
          <a href="../quickstart/" title="Quickstart using EfficientDet" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Quickstart using EfficientDet
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            airctic.com
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://unpkg.com/mermaid@8.4.6/dist/mermaid.min.js"></script>
      
        <script src="../js/termynal.js"></script>
      
        <script src="../js/custom.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3"></script>
      
        <script src="../js/crate.js"></script>
      
    
  </body>
</html>